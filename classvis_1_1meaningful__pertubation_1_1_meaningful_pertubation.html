<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OK-EM: vis.meaningful_pertubation.MeaningfulPertubation Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">OK-EM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>vis</b></li><li class="navelem"><b>meaningful_pertubation</b></li><li class="navelem"><a class="el" href="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation.html">MeaningfulPertubation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">vis.meaningful_pertubation.MeaningfulPertubation Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of <code>Meaningful Perturbation</code> [1] method for deep networks visualization.  
 <a href="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for vis.meaningful_pertubation.MeaningfulPertubation:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation.png" alt=""/>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a75fed47895732000beb0a442ee436aab"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation.html#a75fed47895732000beb0a442ee436aab">__init__</a> (self, Model <a class="el" href="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation.html#a7969346b5b6641358ba21b426c12d107">model</a>, int <a class="el" href="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation.html#a53feab1102233dd69282ce174d255a28">max_iters</a>=500, float <a class="el" href="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation.html#a39aa71bf5ddd52e1f2499f2f47f92a09">lr</a>=0.1, float <a class="el" href="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation.html#a9663fd7b042d83179368a0f0213932a5">l1_coeff</a>=1., float <a class="el" href="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation.html#a0cee27f6d06696cfba75a839d9798ffd">tv_beta</a>=3.0, float <a class="el" href="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation.html#a12c8cac8fa88a21045e590bd6b56768f">tv_coeff</a>=1., Callable <a class="el" href="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation.html#a452320bfcfb39ca6e3e5142ee20369d5">preprocess_fn</a>=preprocess_input)</td></tr>
<tr class="memdesc:a75fed47895732000beb0a442ee436aab"><td class="mdescLeft">&#160;</td><td class="mdescRight">The constructor.  <a href="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation.html#a75fed47895732000beb0a442ee436aab">More...</a><br /></td></tr>
<tr class="separator:a75fed47895732000beb0a442ee436aab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a111131c4296dee8df0046f77532580c4"><td class="memItemLeft" align="right" valign="top">Any&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation.html#a111131c4296dee8df0046f77532580c4">__call__</a> (self, path)</td></tr>
<tr class="memdesc:a111131c4296dee8df0046f77532580c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Explain the model outputs w.r.t an input image.  <a href="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation.html#a111131c4296dee8df0046f77532580c4">More...</a><br /></td></tr>
<tr class="separator:a111131c4296dee8df0046f77532580c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a39aa71bf5ddd52e1f2499f2f47f92a09"><td class="memItemLeft" align="right" valign="top"><a id="a39aa71bf5ddd52e1f2499f2f47f92a09" name="a39aa71bf5ddd52e1f2499f2f47f92a09"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>lr</b></td></tr>
<tr class="memdesc:a39aa71bf5ddd52e1f2499f2f47f92a09"><td class="mdescLeft">&#160;</td><td class="mdescRight">the learning rate. <br /></td></tr>
<tr class="separator:a39aa71bf5ddd52e1f2499f2f47f92a09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9663fd7b042d83179368a0f0213932a5"><td class="memItemLeft" align="right" valign="top"><a id="a9663fd7b042d83179368a0f0213932a5" name="a9663fd7b042d83179368a0f0213932a5"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>l1_coeff</b></td></tr>
<tr class="memdesc:a9663fd7b042d83179368a0f0213932a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">the \(\lambda_1\) coefficient in equation (4). <br /></td></tr>
<tr class="separator:a9663fd7b042d83179368a0f0213932a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cee27f6d06696cfba75a839d9798ffd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation.html#a0cee27f6d06696cfba75a839d9798ffd">tv_beta</a></td></tr>
<tr class="memdesc:a0cee27f6d06696cfba75a839d9798ffd"><td class="mdescLeft">&#160;</td><td class="mdescRight">the \(\beta\) coefficient in eq (4).  <a href="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation.html#a0cee27f6d06696cfba75a839d9798ffd">More...</a><br /></td></tr>
<tr class="separator:a0cee27f6d06696cfba75a839d9798ffd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12c8cac8fa88a21045e590bd6b56768f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation.html#a12c8cac8fa88a21045e590bd6b56768f">tv_coeff</a></td></tr>
<tr class="memdesc:a12c8cac8fa88a21045e590bd6b56768f"><td class="mdescLeft">&#160;</td><td class="mdescRight">the \(\lambda_2\) coefficient in equation (4).  <a href="classvis_1_1meaningful__pertubation_1_1_meaningful_pertubation.html#a12c8cac8fa88a21045e590bd6b56768f">More...</a><br /></td></tr>
<tr class="separator:a12c8cac8fa88a21045e590bd6b56768f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7969346b5b6641358ba21b426c12d107"><td class="memItemLeft" align="right" valign="top"><a id="a7969346b5b6641358ba21b426c12d107" name="a7969346b5b6641358ba21b426c12d107"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>model</b></td></tr>
<tr class="memdesc:a7969346b5b6641358ba21b426c12d107"><td class="mdescLeft">&#160;</td><td class="mdescRight">the model to be explained. <br /></td></tr>
<tr class="separator:a7969346b5b6641358ba21b426c12d107"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53feab1102233dd69282ce174d255a28"><td class="memItemLeft" align="right" valign="top"><a id="a53feab1102233dd69282ce174d255a28" name="a53feab1102233dd69282ce174d255a28"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>max_iters</b></td></tr>
<tr class="memdesc:a53feab1102233dd69282ce174d255a28"><td class="mdescLeft">&#160;</td><td class="mdescRight">the maximum number of iterations for optimization. <br /></td></tr>
<tr class="separator:a53feab1102233dd69282ce174d255a28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bb99ba3fa5fcc91a81c17d18728b3e6"><td class="memItemLeft" align="right" valign="top"><a id="a0bb99ba3fa5fcc91a81c17d18728b3e6" name="a0bb99ba3fa5fcc91a81c17d18728b3e6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>upsampler</b></td></tr>
<tr class="memdesc:a0bb99ba3fa5fcc91a81c17d18728b3e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">the <code>tensorflow.keras.layers.UpSampling2D</code> operator to make mask sizes equal to those of input images. <br /></td></tr>
<tr class="separator:a0bb99ba3fa5fcc91a81c17d18728b3e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a452320bfcfb39ca6e3e5142ee20369d5"><td class="memItemLeft" align="right" valign="top"><a id="a452320bfcfb39ca6e3e5142ee20369d5" name="a452320bfcfb39ca6e3e5142ee20369d5"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>preprocess_fn</b></td></tr>
<tr class="memdesc:a452320bfcfb39ca6e3e5142ee20369d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">A <code>Callable</code> object to pre-process image data. <br /></td></tr>
<tr class="separator:a452320bfcfb39ca6e3e5142ee20369d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e1b41613f66e3dead0a443101839f91"><td class="memItemLeft" align="right" valign="top"><a id="a3e1b41613f66e3dead0a443101839f91" name="a3e1b41613f66e3dead0a443101839f91"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>optim</b></td></tr>
<tr class="memdesc:a3e1b41613f66e3dead0a443101839f91"><td class="mdescLeft">&#160;</td><td class="mdescRight">A <code>tensorflow.keras.optimizers.Adam</code> object for optimization. <br /></td></tr>
<tr class="separator:a3e1b41613f66e3dead0a443101839f91"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Implementation of <code>Meaningful Perturbation</code> [1] method for deep networks visualization. </p>
<p >We follow the equation (4) in the paper for loss computation: \(L=\lambda_1\|\mathbf{1}-\mathbf{m}\|_1+\lambda_2\sum_u\|\nabla\mathbf{m}_u\|^{\beta}+\mathbb{E}_{\mathbf{n}}\left(f_c(\mathbf{x}+\mathbf{n}),\mathbf{m}\right)\).</p>
<p >Usage: </p><div class="fragment"><div class="line">&gt;&gt;&gt; mp = MeaningfulPertubation(model=Resnet50(weights=<span class="stringliteral">&#39;imagenet&#39;</span>))</div>
<div class="line">&gt;&gt;&gt; mask, orig, blurred =  mp(<span class="stringliteral">&#39;./dog,jpg&#39;</span>)</div>
</div><!-- fragment --><p >[1] Ruth C. Fong, Andrea Vedaldi; Proceedings of the IEEE International Conference on Computer Vision (ICCV), 2017, pp. 3429-3437. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a75fed47895732000beb0a442ee436aab" name="a75fed47895732000beb0a442ee436aab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75fed47895732000beb0a442ee436aab">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None vis.meaningful_pertubation.MeaningfulPertubation.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Model&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &#160;</td>
          <td class="paramname"><em>max_iters</em> = <code>500</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &#160;</td>
          <td class="paramname"><em>lr</em> = <code>0.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &#160;</td>
          <td class="paramname"><em>l1_coeff</em> = <code>1.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &#160;</td>
          <td class="paramname"><em>tv_beta</em> = <code>3.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &#160;</td>
          <td class="paramname"><em>tv_coeff</em> = <code>1.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Callable &#160;</td>
          <td class="paramname"><em>preprocess_fn</em> = <code>preprocess_input</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">model</td><td>(<code>tensorflow.keras.models.Model</code>): the <code>tensorflow.keras.models.Model</code> object for inference. </td></tr>
    <tr><td class="paramname">max_iters</td><td>(int, optional): the maximum number of iterations for optimization. Defaults to 500. </td></tr>
    <tr><td class="paramname">lr</td><td>(float, optional): the learning rate. Defaults to 0.1. </td></tr>
    <tr><td class="paramname">l1_coeff</td><td>(float, optional): the \(\lambda_1\) coefficient in equation (4). Defaults to 1. </td></tr>
    <tr><td class="paramname">tv_beta</td><td>(float, optional): the \(\beta\) coefficient in eq (4). Defaults to 3.0. </td></tr>
    <tr><td class="paramname">tv_coeff</td><td>(float, optional): the \(\lambda_2\) coefficient in equation (4). Defaults to 1. </td></tr>
    <tr><td class="paramname">preprocess_fn</td><td>(<code>Callable</code>, optional): A <code>Callable</code> object to pre-process image data. Defaults to <code>tensorflow.keras.applications.resnet.preprocess_input</code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a111131c4296dee8df0046f77532580c4" name="a111131c4296dee8df0046f77532580c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a111131c4296dee8df0046f77532580c4">&#9670;&nbsp;</a></span>__call__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Any vis.meaningful_pertubation.MeaningfulPertubation.__call__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Explain the model outputs w.r.t an input image. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>(str): The path to the image. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mask and blurred images. </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a0cee27f6d06696cfba75a839d9798ffd" name="a0cee27f6d06696cfba75a839d9798ffd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cee27f6d06696cfba75a839d9798ffd">&#9670;&nbsp;</a></span>tv_beta</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vis.meaningful_pertubation.MeaningfulPertubation.tv_beta</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the \(\beta\) coefficient in eq (4). </p>
<p >It magnifies the power of gradients. </p>

</div>
</div>
<a id="a12c8cac8fa88a21045e590bd6b56768f" name="a12c8cac8fa88a21045e590bd6b56768f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12c8cac8fa88a21045e590bd6b56768f">&#9670;&nbsp;</a></span>tv_coeff</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vis.meaningful_pertubation.MeaningfulPertubation.tv_coeff</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the \(\lambda_2\) coefficient in equation (4). </p>
<p >It regularizes the Total Variation. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
